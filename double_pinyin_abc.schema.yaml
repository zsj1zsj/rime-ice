# Rime schema
# encoding: utf-8

schema:
  schema_id: double_pinyin_abc  # ä¸“æœ‰çš„æ–¹æ¡ˆæ ‡è¯†
  name: æ™ºèƒ½ABCåŒæ‹¼
  version: "0.17"
  author:
    - ä½›æŒ¯ <chen.sst@gmail.com>
  description: |
    æ™ºèƒ½ABCåŒæ‹¼æ–¹æ¡ˆã€‚
  dependencies:
    - stroke

switches:
  - name: ascii_mode
    states: [ ä¸­, A ]
    reset: 0
  - name: full_shape
    # states: [ åŠè§’, å…¨è§’ ]
    reset: 0
  - name: ascii_punct
    states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]  # ä¸­è‹±æ ‡ç‚¹
    reset: 0
  - name: traditionalization
    states: [ ç®€, ç¹ ]
    reset: 0
  - name: emoji
    states: [ ğŸ’€, ğŸ˜„ ]
    reset: 1

engine:
  processors:
    - lua_processor@select_character  # ä»¥è¯å®šå­—
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - script_translator
    - lua_translator@date_translator      # æ—¶é—´ã€æ—¥æœŸã€æ˜ŸæœŸ
    - table_translator@custom_phrase      # è‡ªå®šä¹‰çŸ­è¯­
    - table_translator@melt_eng           # è‹±æ–‡è¾“å…¥
    - reverse_lookup_translator@liangfen  # åæŸ¥ï¼Œä¸¤åˆ†æ‹¼å­—
    - lua_translator@unicode              # Unicode
  filters:
    - simplifier@emoji                  # Emoji
    - simplifier@traditionalize         # ç®€ç¹åˆ‡æ¢
    - lua_filter@reduce_english_filter  # é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®
    - uniquifier                        # å»é‡




# Lua é…ç½®: æ—¥æœŸã€æ—¶é—´ã€æ˜ŸæœŸã€ISO 8601ã€æ—¶é—´æˆ³çš„è§¦å‘å…³é”®å­—
date_translator:
  date: date            # æ—¥æœŸï¼š 2022-11-29
  time: time            # æ—¶é—´ï¼š 18:13
  week: week            # æ˜ŸæœŸï¼š æ˜ŸæœŸäºŒ
  datetime: datetime    # ISO 8601ï¼š 2022-11-29T18:13:11+08:00
  timestamp: timestamp  # æ—¶é—´æˆ³ï¼š 1669716794


# Lua é…ç½®: é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®
# è¯¦ç»†ä»‹ç» https://dvel.me/posts/make-rime-en-better/#çŸ­å•è¯ç½®é¡¶çš„é—®é¢˜
# æ­£å¸¸æƒ…å†µï¼š è¾“å…¥ rug å¾—åˆ° ã€Œ1.rug 2.å¦‚æœ â€¦â€¦ ã€
# é™ä½ä¹‹åï¼š è¾“å…¥ rug å¾—åˆ° ã€Œ1.å¦‚æœ 2.rug â€¦â€¦ ã€
reduce_english_filter:
  # é™ä½åˆ°ç¬¬ idx ä¸ªä½ç½®
  idx: 2
  # è¦é™ä½çš„å•è¯ï¼ŒåŒ¹é…çš„æ˜¯è¾“å…¥ç ï¼Œå³å…¨å°å†™ã€‚
  words: [rug, bus, ship, laos, bail, bam, bans, bib, bos, chic, chit, dab, dag, dal, dit, dub, dug, fab, gam, ger, gus, hem, hep, hud, kat, lam, lax, lex, lug, lux, moc, mos, mot, mum, nad, nay, nib, nip, pak, pap, pax, rig, rum, sac, sal, sax, sec, shin, sis, ska, slang, sus, tad, taj, tac, tic, yep, yum]


# ä» default ç»§æ‰¿å¿«æ·é”®
key_binder:
  import_preset: default
  # bindings: # ä¹Ÿå¯ä»¥å¢åŠ æ–¹æ¡ˆä¸“å±çš„å¿«æ·é”®


# Emoji
emoji:
  opencc_config: emoji.json
  option_name: emoji


# ç®€ç¹åˆ‡æ¢
traditionalize:
  option_name: traditionalization
  opencc_config: s2t.json             # s2t.json | s2hk.json | s2tw.json | s2twp.json
  tips: all                           # è½¬æ¢æç¤º: all éƒ½æ˜¾ç¤º | char ä»…å•å­—æ˜¾ç¤º | none ä¸æ˜¾ç¤ºã€‚
  excluded_types: [ reverse_lookup ]  # ä¸è½¬æ¢åæŸ¥ï¼ˆä¸¤åˆ†æ‹¼å­—ï¼‰çš„å†…å®¹


# è‡ªå®šä¹‰çŸ­è¯­
custom_phrase:
  dictionary: ""
  user_dict: custom_phrase_double  # éœ€è¦æ‰‹åŠ¨åˆ›å»º custom_phrase_double.txt æ–‡ä»¶
  db_class: stabledb
  enable_completion: false # è¡¥å…¨æç¤º
  enable_sentence: false   # ç¦æ­¢é€ å¥
  initial_quality: 99      # custom_phrase çš„æƒé‡åº”è¯¥æ¯” pinyin å’Œ melt_eng å¤§


# å¼•å…¥å…«è‚¡æ–‡
grammar:
  language: zh-hans-t-essay-bgw


# ä¸»ç¿»è¯‘å™¨ï¼Œæ‹¼éŸ³
translator:
  dictionary: rime_ice          # æŒ‚è½½è¯åº“ rime_ice.dict.yaml
  prism: double_pinyin          # å¤šæ–¹æ¡ˆå…±ç”¨ä¸€ä¸ªè¯åº“æ—¶ï¼Œä¸ºé¿å…å†²çªï¼Œéœ€è¦ç”¨ prism æŒ‡å®šä¸€ä¸ªåå­—ã€‚
  contextual_suggestions: true  # å¼€å¯å…«è‚¡æ–‡
  initial_quality: 1.2          # æ‹¼éŸ³çš„æƒé‡åº”è¯¥æ¯”è‹±æ–‡å¤§
  preedit_format:               # preedit_format å½±å“åˆ°è¾“å…¥æ¡†çš„æ˜¾ç¤ºå’Œâ€œShift+å›è½¦â€ä¸Šå±çš„å­—ç¬¦
    - xform/o(\w)/0$1/        # é›¶è²æ¯å…ˆæ”¹çˆ²0ï¼Œä»¥æ–¹ä¾¿å¾Œé¢çš„è½‰æ›
    - xform/(\w)q/$1ei/       # é›™æ‹¼ç¬¬äºŒç¢¼è½‰æ›çˆ²éŸ»æ¯
    - xform/(\w)n/$1un/       # æå‰è½‰æ›é›™æ‹¼ç¢¼ n å’Œ gï¼Œå› çˆ²è½‰æ›å¾Œçš„æ‹¼éŸ³è£å°±å¿«è¦å‡ºç¾é€™å…©å€‹å­—æ¯äº†ï¼Œé‚£æ™‚å°‡é›£ä»¥åˆ†è¾¨å‡ºé›™æ‹¼ç¢¼
    - xform/(\w)g/$1eng/      # ç•¶ç„¶ä¹Ÿå¯ä»¥æ¡å–äº‹å…ˆå°‡é›™æ‹¼ç¢¼è®Šçˆ²å¤§å¯«çš„è¾¦æ³•ä¾†èˆ‡è½‰æ›éçš„æ‹¼éŸ³åšå€åˆ†ï¼Œå¯èª°è®“æˆ‘æ˜¯é«˜æ‰‹å‘¢
    - xform/(\w)w/$1ian/
    - xform/([dtnljqx])r/$1iu/  # å°æ‡‰å¤šç¨®éŸ»æ¯çš„é›™æ‹¼ç¢¼ï¼ŒæŒ‰æ­é…çš„è²æ¯åšå€åˆ†ï¼ˆæœ€å¥½åˆ¥ç”¨æ’é™¤å¼å¦‚ [^o]r å®¹æ˜“å‡ºç‹€æ³ï¼‰
    - xform/0r/0er/             # å¦ä¸€ç¨®æƒ…æ³ï¼Œæ³¨æ„å…ˆä¸æ¶ˆé™¤0ï¼Œä»¥é˜²å¾Œé¢æŠŠeç•¶ä½œè²æ¯è½‰æ›çˆ²ch
    - xform/([nljqx])t/$1iang/
    - xform/(\w)t/$1uang/       # ä¸Šä¸€è¡Œå·²ç¶“æŠŠå°æ‡‰åˆ° iang çš„é›™æ‹¼ç¢¼ t æ¶ˆæ»…ï¼Œæ–¼æ˜¯é€™è£ä¸ç”¨å†åˆ—èˆ‰ç›¸é…çš„è²æ¯
    - xform/(\w)y/$1ing/
    - xform/([dtnlgkhaevrzcs])o/$1uo/
    - xform/(\w)p/$1uan/
    - xform/([jqx])s/$1iong/
    - xform/(\w)s/$1ong/
    - xform/([gkhaevrzcs])d/$1ua/
    - xform/(\w)d/$1ia/
    - xform/(\w)f/$1en/
    - xform/(\w)h/$1ang/
    - xform/(\w)j/$1an/
    - xform/(\w)k/$1ao/       # é»˜é»˜æª¢æŸ¥ï¼šé›™æ‹¼ç¢¼ o å·²ç¶“è½‰æ›éäº†
    - xform/(\w)l/$1ai/
    - xform/(\w)z/$1iao/
    - xform/(\w)x/$1ie/
    - xform/([gkhaev])c/$1uai/
    - xform/(\w)c/$1in/
    - xform/(\w)b/$1ou/
    - xform/([nl])m/$1ve/
    - xform/([jqxy])m/$1ue/
    - xform/(\w)m/$1ui/
    - "xform/(^|[ '])a/$1zh/"  # å¾©åŸè²æ¯ï¼ŒéŸ³ç¯€é–‹å§‹è™•çš„é›™æ‹¼å­—æ¯aæ”¹å¯«çˆ²zhï¼›å…¶ä»–ä½ç½®çš„æ‰çœŸæ­£æ˜¯a
    - "xform/(^|[ '])e/$1ch/"
    - "xform/(^|[ '])v/$1sh/"
    - xform/0(\w)/$1/          # å¥½äº†ï¼Œç¾åœ¨å¯ä»¥æŠŠé›¶è²æ¯æ‹¿æ‰å•¦
    - xform/([nl])v/$1Ã¼/       # é€™æ¨£çº”æ˜¯æ¼¢èªæ‹¼éŸ³ :-)
    - xform/([jqxy])v/$1u/


# æ¬¡ç¿»è¯‘å™¨ï¼Œè‹±æ–‡
melt_eng:
  dictionary: melt_eng     # æŒ‚è½½è¯åº“ melt_eng.dict.yaml
  enable_sentence: false   # ç¦æ­¢é€ å¥
  enable_user_dict: false  # ç¦ç”¨ç”¨æˆ·è¯å…¸
  initial_quality: 1.1     # åˆå§‹æƒé‡
  comment_format:          # è‡ªå®šä¹‰æç¤ºç 
    - xform/.*//           # æ¸…ç©ºæç¤ºç 


# æ ‡ç‚¹ç¬¦å·
# å…±äº«ç›®å½•é¢„è®¾çš„ punctuation.yaml åŒ…å«äº† full_shape half_shape ï¼ˆå…¨è§’å’ŒåŠè§’çš„ç¬¦å·æ˜ å°„ï¼‰
# å…±äº«ç›®å½•é¢„è®¾çš„ symbols.yaml     åŒ…å«äº† full_shape half_shape symbols
# symbols çš„åŠŸèƒ½æ˜¯æ”¯æŒä»¥ã€Œ/ã€å‰ç¼€å¼€å¤´è¾“å‡ºä¸€ç³»åˆ—å­—ç¬¦ï¼Œè‡ªå®šä¹‰çš„ symbols_custom_double.yaml ä¿®æ”¹æˆäº†ã€ŒVã€å¼€å¤´ã€‚
punctuator:
  # __include: punctuation:/          # ä»å…±äº«ç›®å½•å¼•å…¥é¢„è®¾çš„ punctuation.yaml
  # import_preset: symbols            # ä»å…±äº«ç›®å½•å¼•å…¥é¢„è®¾çš„ symbols.yaml
  import_preset: symbols_custom       # ä» symbols_custom.yaml å¼•å…¥è‡ªå·±è‡ªå®šä¹‰çš„
  __include: symbols_custom_double:/  # ä» symbols_custom_double.yaml æ›¿æ¢ä¸ºé€‚ç”¨äºåŒæ‹¼çš„ symbols
  # ä¹Ÿå¯ä»¥ç›´æ¥åœ¨è¿™é‡Œé…ç½®ï¼š
  # full_shape:
    # ...
  # half_shape:
    # ...
  # symbols:
    # ...


# å¤„ç†ç¬¦åˆç‰¹å®šè§„åˆ™çš„è¾“å…¥ç ï¼Œå¦‚ç½‘å€ã€åæŸ¥
recognizer:
  patterns:
    email: "^[A-Za-z][-_.0-9A-Za-z]*@.*$"                            # è‡ªå¸¦çš„ï¼Œe-mail æ­£åˆ™
    # uppercase: "[A-Z][-_+.'0-9A-Za-z]*$"                           # è‡ªå¸¦çš„ï¼Œå¤§å†™å­—æ¯å¼€å¤´åï¼Œå¯ä»¥è¾“å…¥[-_+.'0-9A-Za-z]è¿™äº›å­—ç¬¦
    url: "^(www[.]|https?:|ftp[.:]|mailto:|file:).*$|^[a-z]+[.].+$"  # è‡ªå¸¦çš„ï¼ŒURL æ­£åˆ™
    url_2: "^[A-Za-z]+[.].*"            # æ”¯æŒ google.com abc.txt ç­‰ç½‘å€æˆ–æ–‡ä»¶åï¼Œä¼šå¯¼è‡´å¥å·ä¸ä¼šè®©å¥å­ä¸Šå±ï¼Œæˆ–ä½¿ç”¨å¥å·ç¿»é¡µæ—¶éœ€è¦æ³¨é‡Šæ‰
    win_path: "^[A-Za-z]:.*"            # æ”¯æŒ c:\file\path ä¹‹ç±»çš„è·¯å¾„è¾“å…¥
    colon: "^[A-Za-z]+:.*"              # ä¸Šé¢çš„è¶…é›†ï¼Œå¯ä»¥è¾“å…¥å†’å·ï¼Œä¸ä¼šå¯¼è‡´å¥å­ç›´æ¥ä¸Šå±
    underscore: "^[A-Za-z]+_.*"         # å¯ä»¥è¾“å…¥ä¸‹åˆ’çº¿ _ ï¼Œä¸ä¼šå¯¼è‡´å¥å­ç›´æ¥ä¸Šå±
    punct: "^V([0-9]|10|[A-Za-z]+)$"    # å“åº” symbols_custom_double.yaml ä¸‹çš„ symbolsï¼Œç”¨ã€ŒVã€æ›¿æ¢ã€Œ/ã€å¹¶æ”¯æŒå¤§å†™
    reverse_lookup: '^L[a-z]+$'         # å“åº”ä¸¤åˆ†çš„åæŸ¥
    unicode: "^U[a-f0-9]+"              # å“åº” Unicode


# åæŸ¥ï¼šä¸¤åˆ†ï¼ˆæ‹¼å­—ï¼‰
liangfen:
  dictionary: liangfen     # ä¸¤åˆ†è¯å…¸ liangfen.dict.yaml
  prefix: 'L'              # ä»¥ L å¼€å¤´æ¥åæŸ¥
  enable_completion: true  # è¡¥å…¨æç¤º
  # tips: ã€”ä¸¤åˆ†ã€•          # åæŸ¥æ—¶æ˜¾ç¤ºçš„æ–‡å­—ï¼Œå»ºè®®æ³¨é‡Šæ‰ï¼Œå¦åˆ™å¾ˆå¤š L å¼€å¤´çš„è‹±æ–‡å•è¯ä¹Ÿä¼šæ˜¾ç¤ºè¿™ä¸ª

speller:
  alphabet: zyxwvutsrqponmlkjihgfedcba  # å‘ƒï¼Œå€’èƒŒå­—æ¯è¡¨å®Œå…¨æ˜¯å€‹äººå–œå¥½
  delimiter: " '"  # éš”éŸ³ç¬¦è™Ÿç”¨ã€Œ'ã€ï¼›ç¬¬ä¸€ä½çš„ç©ºç™½ç”¨ä¾†è‡ªå‹•æ’å…¥åˆ°éŸ³ç¯€é‚Šç•Œè™•
  algebra:  # æ‹¼å¯«é‹ç®—è¦å‰‡ï¼Œé€™å€‹çº”æ˜¯å¯¦ç¾é›™æ‹¼æ–¹æ¡ˆçš„é‡é»ã€‚å¯«æ³•æœ‰å¾ˆå¤šç¨®ï¼Œç•¶ç„¶ä¹Ÿå¯ä»¥æŠŠå››ç™¾å¤šå€‹éŸ³ç¯€ç¢¼ä¸€æ¢ä¸€æ¢åœ°åˆ—èˆ‰
    - erase/^xx$/             # ç¢¼è¡¨ä¸­æœ‰å¹¾å€‹æ‹¼éŸ³ä¸æ˜çš„å­—ï¼Œç·¨ç¢¼æˆxxäº†ï¼Œæ¶ˆæ»…ä»–
    - derive/^([jqxy])u$/$1v/
    - xform/^zh/A/            # æ›¿æ›è²æ¯éµï¼Œç”¨å¤§å¯«ä»¥é˜²èˆ‡åŸæœ‰çš„å­—æ¯æ··æ·†
    - xform/^ch/E/
    - xform/^sh/V/
    - xform/^([aoe].*)$/O$1/  # æ·»ä¸Šå›ºå®šçš„é›¶è²æ¯oï¼Œå…ˆæ¨™è¨˜çˆ²å¤§å¯«O
    - xform/ei$/Q/            # æ›¿æ›éŸ»æ¯éµ
    - xform/ian$/W/           # â€»2
    - xform/er$|iu$/R/        # å°æ‡‰å…©ç¨®éŸ»æ¯çš„ï¼›éŸ³ç¯€erç¾åœ¨è®Šçˆ²ORäº†
    - xform/[iu]ang$/T/       # â€»1
    - xform/ing$/Y/
    - xform/uo$/O/
    - xform/uan$/P/           # â€»3
    - xform/i?ong$/S/
    - xform/[iu]a$/D/
    - xform/en$/F/
    - xform/eng$/G/
    - xform/ang$/H/           # æª¢æŸ¥ä¸€ä¸‹åœ¨æ­¤ä¹‹å‰æ˜¯å¦å·²è½‰æ›éäº†å¸¶ç•ŒéŸ³çš„angï¼›å¥½ï¼Œâ€»1è™•æœ‰äº†
    - xform/an$/J/            # å¦‚æœâ€»2ã€â€»3é‚„ç„¡æœ‰å‡ºç¾åœ¨ä¸Šæ–‡ä¸­ï¼Œæ‡‰è©²æŠŠä»–å€‘æåˆ°æœ¬è¡Œä¹‹å‰
    - xform/iao$/Z/           # å°â€”â€”åƒé€™æ¨£è®“iaoæå‰å‡ºå ´
    - xform/ao$/K/
    - xform/in$|uai$/C/       # è®“uaiæå‰å‡ºå ´
    - xform/ai$/L/
    - xform/ie$/X/
    - xform/ou$/B/
    - xform/un$/N/
    - xform/[uv]e$|ui$/M/
    - xlit/QWERTYOPASDFGHJKLZXCVBNM/qwertyopasdfghjklzxcvbnm/  # æœ€å¾ŒæŠŠé›™æ‹¼ç¢¼å…¨éƒ¨è®Šå°å¯«